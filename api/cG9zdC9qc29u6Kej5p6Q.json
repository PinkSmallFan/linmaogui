{"title":"json解析","date":"2018-10-24T01:34:56.000Z","slug":"json解析","tags":["java"],"updated":"2018-11-02T13:02:00.914Z","content":"<h2 id=\"JSON结构\"><a href=\"#JSON结构\" class=\"headerlink\" title=\"JSON结构\"></a>JSON结构</h2><h3 id=\"结构\"><a href=\"#结构\" class=\"headerlink\" title=\"结构\"></a>结构</h3><figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">\t<span class=\"attr\">\"workers\"</span>:[</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"attr\">\"id\"</span>:<span class=\"string\">\"1\"</span>,</span><br><span class=\"line\">\t\t<span class=\"attr\">\"name\"</span>:<span class=\"string\">\"programmer\"</span></span><br><span class=\"line\">\t&#125;,</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"attr\">\"id\"</span>:<span class=\"string\">\"2\"</span>,</span><br><span class=\"line\">\t\t<span class=\"attr\">\"name\"</span>:<span class=\"string\">\"productManager\"</span></span><br><span class=\"line\">\t&#125;,</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"attr\">\"id\"</span>:<span class=\"string\">\"3\"</span>,</span><br><span class=\"line\">\t\t<span class=\"attr\">\"name\"</span>:<span class=\"string\">\"leader\"</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"bean实例\"><a href=\"#bean实例\" class=\"headerlink\" title=\"bean实例\"></a>bean实例</h3><h4 id=\"一个单位对应一个bean\"><a href=\"#一个单位对应一个bean\" class=\"headerlink\" title=\"一个单位对应一个bean\"></a>一个单位对应一个bean</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Worker</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">private</span> <span class=\"keyword\">int</span> id;</span><br><span class=\"line\">\t<span class=\"keyword\">private</span> String name;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">getId</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> id;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setId</span><span class=\"params\">(<span class=\"keyword\">int</span> id)</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">this</span>.id = id;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">getName</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> name;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setName</span><span class=\"params\">(String name)</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"一个集合对应一个bean\"><a href=\"#一个集合对应一个bean\" class=\"headerlink\" title=\"一个集合对应一个bean\"></a>一个集合对应一个bean</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Workers</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">private</span> List&lt;Worker&gt; workers;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> List&lt;Worker&gt; <span class=\"title\">getWorkers</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> workers;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setWorkers</span><span class=\"params\">(List&lt;Worker&gt; workers)</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">this</span>.workers = workers;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"举例\"><a href=\"#举例\" class=\"headerlink\" title=\"举例\"></a>举例</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">JSONUtils</span></span>&#123;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">\t * </span></span><br><span class=\"line\"><span class=\"comment\">\t * &lt;/p&gt; 说明：&lt;/p&gt; </span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@param</span> path\t\t读取目录结构的路径，例如：\"/src/workers.json\"</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@return</span>\t\t\t目录结构</span></span><br><span class=\"line\"><span class=\"comment\">\t * </span></span><br><span class=\"line\"><span class=\"comment\">\t */</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Workers <span class=\"title\">getMap</span><span class=\"params\">(String path)</span> <span class=\"keyword\">throws</span> IOException</span>&#123;</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\tInputStream inputStream = JSONUtils.class.getClassLoader().getResourceAsStream(path);</span><br><span class=\"line\">\t\tString json = readAsString(inputStream);</span><br><span class=\"line\">\t\tJSONObject jsonObject = JSONObject.fromObject(json);</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\t<span class=\"comment\">//修改类型，解决JSON net.sf.ezmorph.bean.MorphDynaBean cannot be cast to com.xxx.xxxx.vo.Work的错误</span></span><br><span class=\"line\">\t\tMap classMap = <span class=\"keyword\">new</span> HashMap();</span><br><span class=\"line\">\t\tclassMap.put(<span class=\"string\">\"workers\"</span>, Worker.class);</span><br><span class=\"line\">\t\tJSONUtils.getMorpherRegistry().registerMorpher(<span class=\"keyword\">new</span> DateMorpher(<span class=\"keyword\">new</span> String[] &#123;<span class=\"string\">\"yyyy-MM-dd\"</span>, <span class=\"string\">\"yyyy-MM-dd HH:mm:ss\"</span>&#125;));</span><br><span class=\"line\">\t\tWorkers workers = (Workers) JSONObject.toBean(jsonObject, Workers.class, classMap);</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> Workers;</span><br><span class=\"line\">\t&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"备注\"><a href=\"#备注\" class=\"headerlink\" title=\"备注\"></a>备注</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">\t * 输出从指定路径+文件名读取到的文件流的字符内容。</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@param</span> inputStream\t输入流</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@throws</span> IOException</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> String <span class=\"title\">readAsString</span><span class=\"params\">(InputStream inputStream)</span><span class=\"keyword\">throws</span> IOException</span>&#123;</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\tBufferedReader reader = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">\t\tStringBuilder sb = <span class=\"keyword\">new</span> StringBuilder();</span><br><span class=\"line\">\t\tString line;</span><br><span class=\"line\">\t\t<span class=\"keyword\">try</span>&#123;</span><br><span class=\"line\">\t\t\treader = <span class=\"keyword\">new</span> BufferedReader(<span class=\"keyword\">new</span> InputStreamReader(inputStream, <span class=\"string\">\"utf-8\"</span>));</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">while</span>((line = reader.readLine()) != <span class=\"keyword\">null</span>)&#123;</span><br><span class=\"line\">\t\t\t\tsb.append(line);</span><br><span class=\"line\">\t\t\t\tsb.append(<span class=\"string\">\"\\r\\n\"</span>);</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> sb.toString();</span><br><span class=\"line\">\t\t&#125;<span class=\"keyword\">finally</span>&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span>(reader != <span class=\"keyword\">null</span>)&#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">try</span>&#123;</span><br><span class=\"line\">\t\t\t\t\treader.close();</span><br><span class=\"line\">\t\t\t\t&#125;<span class=\"keyword\">catch</span> (IOException e) &#123;</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br></pre></td></tr></table></figure>\n","prev":{"title":"PKI技术","slug":"PKI技术"},"next":{"title":"kailLinux的使用","slug":"kailLinux的使用"},"link":"http://wenchongjiaokou.info./2018/10/24/json解析/","toc":[{"title":"JSON结构","id":"JSON结构","index":"1","children":[{"title":"结构","id":"结构","index":"1.1"},{"title":"bean实例","id":"bean实例","index":"1.2","children":[{"title":"一个单位对应一个bean","id":"一个单位对应一个bean","index":"1.2.1"},{"title":"一个集合对应一个bean","id":"一个集合对应一个bean","index":"1.2.2"}]},{"title":"举例","id":"举例","index":"1.3"},{"title":"备注","id":"备注","index":"1.4"}]}]}