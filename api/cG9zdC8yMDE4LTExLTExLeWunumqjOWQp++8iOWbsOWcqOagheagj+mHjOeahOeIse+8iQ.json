{"title":"实验吧（困在栅栏里的爱）","date":"2018-11-11T08:56:50.000Z","slug":"2018-11-11-实验吧（困在栅栏里的爱）","tags":["other","实验吧","密码学"],"updated":"2018-11-11T12:51:43.131Z","content":"<h2 id=\"困在栅栏里的爱\"><a href=\"#困在栅栏里的爱\" class=\"headerlink\" title=\"困在栅栏里的爱\"></a>困在栅栏里的爱</h2><h3 id=\"题目\"><a href=\"#题目\" class=\"headerlink\" title=\"题目\"></a>题目</h3><p>最近一直在好奇一个问题，QWE到底等不等于ABC？</p>\n<p>-.- .. –.- .-.. .– - ..-. -.-. –.- –. -. … — — </p>\n<p>flag格式：CTF{xxx}</p>\n<p>题目地址：<a href=\"http://www.shiyanbar.com/ctf/1917\" target=\"_blank\" rel=\"noopener\">http://www.shiyanbar.com/ctf/1917</a></p>\n<h3 id=\"解题思路\"><a href=\"#解题思路\" class=\"headerlink\" title=\"解题思路\"></a>解题思路</h3><h4 id=\"莫斯密码\"><a href=\"#莫斯密码\" class=\"headerlink\" title=\"莫斯密码\"></a>莫斯密码</h4><p>自己编写一个morse解码</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!/usr/bin/env python</span></span><br><span class=\"line\"><span class=\"comment\"># -*- coding: utf-8 -*-</span></span><br><span class=\"line\"><span class=\"string\">'''</span></span><br><span class=\"line\"><span class=\"string\">&#123;</span></span><br><span class=\"line\"><span class=\"string\">Title:MorseCode</span></span><br><span class=\"line\"><span class=\"string\">Author:PinkSmallFan</span></span><br><span class=\"line\"><span class=\"string\">Type:crypto</span></span><br><span class=\"line\"><span class=\"string\">Detail:莫斯密码</span></span><br><span class=\"line\"><span class=\"string\">&#125;</span></span><br><span class=\"line\"><span class=\"string\">'''</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">morse</span><span class=\"params\">(lstr)</span>:</span></span><br><span class=\"line\">    flag = <span class=\"string\">''</span></span><br><span class=\"line\">    data = lstr.split(<span class=\"string\">' '</span>)</span><br><span class=\"line\">    dict = &#123;<span class=\"string\">'.-'</span>: <span class=\"string\">'A'</span>,</span><br><span class=\"line\">            <span class=\"string\">'-...'</span>: <span class=\"string\">'B'</span>,</span><br><span class=\"line\">            <span class=\"string\">'-.-.'</span>: <span class=\"string\">'C'</span>,</span><br><span class=\"line\">            <span class=\"string\">'-..'</span>:<span class=\"string\">'D'</span>,</span><br><span class=\"line\">            <span class=\"string\">'.'</span>:<span class=\"string\">'E'</span>,</span><br><span class=\"line\">            <span class=\"string\">'..-.'</span>:<span class=\"string\">'F'</span>,</span><br><span class=\"line\">            <span class=\"string\">'--.'</span>: <span class=\"string\">'G'</span>,</span><br><span class=\"line\">            <span class=\"string\">'....'</span>: <span class=\"string\">'H'</span>,</span><br><span class=\"line\">            <span class=\"string\">'..'</span>: <span class=\"string\">'I'</span>,</span><br><span class=\"line\">            <span class=\"string\">'.---'</span>:<span class=\"string\">'J'</span>,</span><br><span class=\"line\">            <span class=\"string\">'-.-'</span>: <span class=\"string\">'K'</span>,</span><br><span class=\"line\">            <span class=\"string\">'.-..'</span>: <span class=\"string\">'L'</span>,</span><br><span class=\"line\">            <span class=\"string\">'--'</span>: <span class=\"string\">'M'</span>,</span><br><span class=\"line\">            <span class=\"string\">'-.'</span>: <span class=\"string\">'N'</span>,</span><br><span class=\"line\">            <span class=\"string\">'---'</span>: <span class=\"string\">'O'</span>,</span><br><span class=\"line\">            <span class=\"string\">'.--.'</span>: <span class=\"string\">'P'</span>,</span><br><span class=\"line\">            <span class=\"string\">'--.-'</span>: <span class=\"string\">'Q'</span>,</span><br><span class=\"line\">            <span class=\"string\">'.-.'</span>: <span class=\"string\">'R'</span>,</span><br><span class=\"line\">            <span class=\"string\">'...'</span>: <span class=\"string\">'S'</span>,</span><br><span class=\"line\">            <span class=\"string\">'-'</span>: <span class=\"string\">'T'</span>,</span><br><span class=\"line\">            <span class=\"string\">'..-'</span>: <span class=\"string\">'U'</span>,</span><br><span class=\"line\">            <span class=\"string\">'...-'</span>: <span class=\"string\">'V'</span>,</span><br><span class=\"line\">            <span class=\"string\">'.--'</span>: <span class=\"string\">'W'</span>,</span><br><span class=\"line\">            <span class=\"string\">'-..-'</span>: <span class=\"string\">'X'</span>,</span><br><span class=\"line\">            <span class=\"string\">'-.--'</span>: <span class=\"string\">'Y'</span>,</span><br><span class=\"line\">            <span class=\"string\">'--..'</span>: <span class=\"string\">'Z'</span>,</span><br><span class=\"line\">            <span class=\"string\">'.----'</span>: <span class=\"string\">'1'</span>,</span><br><span class=\"line\">            <span class=\"string\">'..---'</span>: <span class=\"string\">'2'</span>,</span><br><span class=\"line\">            <span class=\"string\">'...--'</span>: <span class=\"string\">'3'</span>,</span><br><span class=\"line\">            <span class=\"string\">'....-'</span>: <span class=\"string\">'4'</span>,</span><br><span class=\"line\">            <span class=\"string\">'.....'</span>: <span class=\"string\">'5'</span>,</span><br><span class=\"line\">            <span class=\"string\">'-....'</span>: <span class=\"string\">'6'</span>,</span><br><span class=\"line\">            <span class=\"string\">'--...'</span>: <span class=\"string\">'7'</span>,</span><br><span class=\"line\">            <span class=\"string\">'---..'</span>: <span class=\"string\">'8'</span>,</span><br><span class=\"line\">            <span class=\"string\">'----.'</span>: <span class=\"string\">'9'</span>,</span><br><span class=\"line\">            <span class=\"string\">'-----'</span>: <span class=\"string\">'0'</span>,</span><br><span class=\"line\">            <span class=\"string\">'..--..'</span>: <span class=\"string\">'?'</span>,</span><br><span class=\"line\">            <span class=\"string\">'-..-.'</span>: <span class=\"string\">'/'</span>,</span><br><span class=\"line\">            <span class=\"string\">'-.--.-'</span>: <span class=\"string\">'()'</span>,</span><br><span class=\"line\">            <span class=\"string\">'-....-'</span>: <span class=\"string\">'-'</span>,</span><br><span class=\"line\">            <span class=\"string\">'.-.-.-'</span>: <span class=\"string\">'.'</span></span><br><span class=\"line\">            &#125;;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> item <span class=\"keyword\">in</span> data:</span><br><span class=\"line\">        flag+=dict[item]</span><br><span class=\"line\">    <span class=\"keyword\">return</span> flag</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">main</span><span class=\"params\">(lstr)</span>:</span></span><br><span class=\"line\">    print(lstr)</span><br><span class=\"line\">    result = morse(lstr)</span><br><span class=\"line\">    print(result)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> result</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#  example</span></span><br><span class=\"line\"><span class=\"comment\"># print('helloworld')</span></span><br><span class=\"line\"><span class=\"comment\"># abc='-.- .. --.- .-.. .-- - ..-. -.-. --.- --. -. ... --- ---'</span></span><br><span class=\"line\"><span class=\"comment\"># main(abc)</span></span><br><span class=\"line\"><span class=\"comment\"># result为KIQLWTFCQGNSOO</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"替换密码\"><a href=\"#替换密码\" class=\"headerlink\" title=\"替换密码\"></a>替换密码</h4><p>qwe替换abc，即键盘的qwert…键盘从上到下，从左到右转换</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!/usr/bin/env python</span></span><br><span class=\"line\"><span class=\"comment\"># -*- coding: utf-8 -*-</span></span><br><span class=\"line\"><span class=\"string\">'''</span></span><br><span class=\"line\"><span class=\"string\">&#123;</span></span><br><span class=\"line\"><span class=\"string\">Title:QWECode</span></span><br><span class=\"line\"><span class=\"string\">Author:PinkSmallFan</span></span><br><span class=\"line\"><span class=\"string\">Type:crypto</span></span><br><span class=\"line\"><span class=\"string\">Detail:替换密码</span></span><br><span class=\"line\"><span class=\"string\">&#125;</span></span><br><span class=\"line\"><span class=\"string\">'''</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">qweDecode</span><span class=\"params\">(lstr)</span>:</span></span><br><span class=\"line\">    qweData = <span class=\"string\">'QWERTYUIOPASDFGHJKLZXCVBNM'</span></span><br><span class=\"line\">    abcData = <span class=\"string\">'ABCDEFGHIJKLMNOPQRSTUVWXYZ'</span></span><br><span class=\"line\">    returnStr = <span class=\"string\">''</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> data <span class=\"keyword\">in</span> lstr:</span><br><span class=\"line\">        returnStr += abcData[qweData.index(data.upper())]</span><br><span class=\"line\">    <span class=\"keyword\">return</span> returnStr</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">main</span><span class=\"params\">(lstr)</span>:</span></span><br><span class=\"line\">    print(lstr)</span><br><span class=\"line\">    result = qweDecode(lstr)</span><br><span class=\"line\">    print(result)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> result</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># example</span></span><br><span class=\"line\"><span class=\"comment\"># data='KIQLWTFCQGNSOO'</span></span><br><span class=\"line\"><span class=\"comment\"># main(data)</span></span><br><span class=\"line\"><span class=\"comment\"># RHASBENVAOYLII</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"栏删密码\"><a href=\"#栏删密码\" class=\"headerlink\" title=\"栏删密码\"></a>栏删密码</h4><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!/usr/bin/env python</span></span><br><span class=\"line\"><span class=\"comment\"># -*- coding: utf-8 -*-</span></span><br><span class=\"line\"><span class=\"string\">'''</span></span><br><span class=\"line\"><span class=\"string\">&#123;</span></span><br><span class=\"line\"><span class=\"string\">Title:FenceCode</span></span><br><span class=\"line\"><span class=\"string\">Author:PinkSmallFan</span></span><br><span class=\"line\"><span class=\"string\">Type:crypto</span></span><br><span class=\"line\"><span class=\"string\">Detail:栏删密码</span></span><br><span class=\"line\"><span class=\"string\">&#125;</span></span><br><span class=\"line\"><span class=\"string\">'''</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">fenceDecode</span><span class=\"params\">(lstr)</span>:</span></span><br><span class=\"line\"></span><br><span class=\"line\">    decodeStr = <span class=\"string\">''</span></span><br><span class=\"line\">    returnStr = <span class=\"string\">''</span></span><br><span class=\"line\">    fenceSize = <span class=\"number\">1</span></span><br><span class=\"line\">    encodeSize = len(lstr)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">for</span> r <span class=\"keyword\">in</span> range(round(encodeSize/<span class=\"number\">2</span>)):</span><br><span class=\"line\">        fenceSize = r+<span class=\"number\">1</span></span><br><span class=\"line\">        decodeStr = <span class=\"string\">''</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> f <span class=\"keyword\">in</span> range(fenceSize):</span><br><span class=\"line\">            <span class=\"keyword\">for</span> e <span class=\"keyword\">in</span> range(encodeSize):</span><br><span class=\"line\">                <span class=\"keyword\">if</span>((f + e) % fenceSize == <span class=\"number\">0</span>):</span><br><span class=\"line\">                    decodeStr += lstr[e]</span><br><span class=\"line\"></span><br><span class=\"line\">        returnStr += str(fenceSize) + <span class=\"string\">':'</span> + decodeStr + <span class=\"string\">'\\n'</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> returnStr</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">main</span><span class=\"params\">(lstr)</span>:</span></span><br><span class=\"line\">    print(lstr)</span><br><span class=\"line\">    result = fenceDecode(lstr)</span><br><span class=\"line\">    print(result)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> result</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">myround</span><span class=\"params\">(num)</span>:</span></span><br><span class=\"line\">   <span class=\"keyword\">return</span> int(num)+int(<span class=\"number\">2</span>*num)%<span class=\"number\">2</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># example</span></span><br><span class=\"line\"><span class=\"comment\"># data='RHASBENVAOYLII'</span></span><br><span class=\"line\"><span class=\"comment\"># main(data)</span></span><br><span class=\"line\"><span class=\"comment\"># RHASBENVAOYLII</span></span><br><span class=\"line\"><span class=\"comment\"># 1:RHASBENVAOYLII</span></span><br><span class=\"line\"><span class=\"comment\"># 2:RABNAYIHSEVOLI</span></span><br><span class=\"line\"><span class=\"comment\"># 3:RSNOIAEALHBVYI</span></span><br><span class=\"line\"><span class=\"comment\"># 4:RBAISVLANYHEOI</span></span><br><span class=\"line\"><span class=\"comment\"># 5:REYBOSAIAVIHNL</span></span><br><span class=\"line\"><span class=\"comment\"># 6:RNIELBYSOAAHVI</span></span><br><span class=\"line\"><span class=\"comment\"># 7:RVNIEIBLSYAOHA</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># test</span></span><br><span class=\"line\"><span class=\"comment\"># print(myround(6.9/2))</span></span><br><span class=\"line\"><span class=\"comment\"># print(format(5/2, '.1f'))</span></span><br><span class=\"line\"><span class=\"comment\"># print(round(2.5))</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"倒序\"><a href=\"#倒序\" class=\"headerlink\" title=\"倒序\"></a>倒序</h4><p>可以找到栏删密码中，第二个合适，即ILOVESHIYANBAR，接着大小写都试一下，就完成啦~</p>\n","next":{"title":"RSA","slug":"2018-11-9-RSA"},"link":"https://pinksmallfan.github.io/WenChongAndJiaoKou/WenChongAndJiaoKou/2018/11/11/2018-11-11-实验吧（困在栅栏里的爱）/","toc":[{"title":"困在栅栏里的爱","id":"困在栅栏里的爱","index":"1","children":[{"title":"题目","id":"题目","index":"1.1"},{"title":"解题思路","id":"解题思路","index":"1.2","children":[{"title":"莫斯密码","id":"莫斯密码","index":"1.2.1"},{"title":"替换密码","id":"替换密码","index":"1.2.2"},{"title":"栏删密码","id":"栏删密码","index":"1.2.3"},{"title":"倒序","id":"倒序","index":"1.2.4"}]}]}]}