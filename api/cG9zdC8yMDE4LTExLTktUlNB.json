{"title":"RSA","date":"2018-11-09T15:42:42.000Z","slug":"2018-11-9-RSA","tags":["密码学"],"updated":"2018-11-15T16:12:43.059Z","content":"<h2 id=\"Python\"><a href=\"#Python\" class=\"headerlink\" title=\"Python\"></a>Python</h2><h3 id=\"gmpy2\"><a href=\"#gmpy2\" class=\"headerlink\" title=\"gmpy2\"></a>gmpy2</h3><h4 id=\"引用\"><a href=\"#引用\" class=\"headerlink\" title=\"引用\"></a>引用</h4><blockquote>\n<p>import gmpy2<br>divm(…)<br>divm(a, b, m) returns x such that b <em> x == a modulo m. Raises a ZeroDivisionError exception if no such value x exists.<br>invert(…)<br>invert(x, m) returns y such that x </em> y == 1 modulo m, or 0 if no such y exists.</p>\n<p><strong>mpz(…)</strong></p>\n<p>mpz() returns a new <em>mpz</em> object set to 0.</p>\n<p>mpz(n) returns a new <em>mpz</em> object from a numeric value <em>n</em>. If <em>n</em> is not an integer, it will be truncated to an integer.</p>\n<p>mpz(s[, base=0]) returns a new <em>mpz</em> object from a string <em>s</em> made of digits in the given base. If base = 0, thn binary, octal, or hex Python strings are recognized by leading 0b, 0o, or 0x characters. Otherwise the string is assumed to be decimal. Values for base can range between 2 and 62.</p>\n</blockquote>\n<h4 id=\"常用例子\"><a href=\"#常用例子\" class=\"headerlink\" title=\"常用例子\"></a>常用例子</h4><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 已知p、q、e，求d</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> gmpy2</span><br><span class=\"line\">p =gmpy2.mpz(<span class=\"number\">17</span>)</span><br><span class=\"line\">q =gmpy2.mpz(<span class=\"number\">5</span>)</span><br><span class=\"line\">e =gmpy2.mpz(<span class=\"number\">7</span>)</span><br><span class=\"line\">phi_n= (p - <span class=\"number\">1</span>) * (q - <span class=\"number\">1</span>)</span><br><span class=\"line\">d = gmpy2.invert(e, phi_n)</span><br><span class=\"line\">print(<span class=\"string\">\"d is:\"</span>)</span><br><span class=\"line\"><span class=\"keyword\">print</span> (d)</span><br></pre></td></tr></table></figure>\n<h3 id=\"pow\"><a href=\"#pow\" class=\"headerlink\" title=\"pow\"></a>pow</h3><h4 id=\"引用-1\"><a href=\"#引用-1\" class=\"headerlink\" title=\"引用\"></a>引用</h4><blockquote>\n<p>pow(…)<br>pow(x, y, m) returns n such that x ^ y == 1 modulo m. Raises a ZeroDivisionError exception if no such value n exists.</p>\n</blockquote>\n<h4 id=\"常用例子-1\"><a href=\"#常用例子-1\" class=\"headerlink\" title=\"常用例子\"></a>常用例子</h4><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> gmpy2</span><br><span class=\"line\">p =gmpy2.mpz(<span class=\"number\">9648423029010515676590551740010426534945737639235739800643989352039852507298491399561035009163427050370107570733633350911691280297777160200625281665378483</span>)</span><br><span class=\"line\">q =gmpy2.mpz(<span class=\"number\">11874843837980297032092405848653656852760910154543380907650040190704283358909208578251063047732443992230647903887510065547947313543299303261986053486569407</span>)</span><br><span class=\"line\">e =gmpy2.mpz(<span class=\"number\">65537</span>)</span><br><span class=\"line\">phi_n= (p - <span class=\"number\">1</span>) * (q - <span class=\"number\">1</span>)</span><br><span class=\"line\">n=p*q</span><br><span class=\"line\">d = gmpy2.invert(e, phi_n)</span><br><span class=\"line\">c=gmpy2.mpz(<span class=\"number\">83208298995174604174773590298203639360540024871256126892889661345742403314929861939100492666605647316646576486526217457006376842280869728581726746401583705899941768214138742259689334840735633553053887641847651173776251820293087212885670180367406807406765923638973161375817392737747832762751690104423869019034</span>)</span><br><span class=\"line\">m=pow(c,d,n)</span><br><span class=\"line\">print(<span class=\"string\">\"Message is :\"</span>)</span><br><span class=\"line\">print(m)</span><br></pre></td></tr></table></figure>\n<p><a href=\"https://www.freebuf.com/articles/others-articles/166049.html\" target=\"_blank\" rel=\"noopener\">引用地址</a></p>\n","prev":{"title":"实验吧（困在栅栏里的爱）","slug":"2018-11-11-实验吧（困在栅栏里的爱）"},"next":{"title":"微服务实践笔记","slug":"2018-11-8-微服务实践笔记"},"link":"http://wenchongjiaokou.info./2018/11/09/2018-11-9-RSA/","toc":[{"title":"Python","id":"Python","index":"1","children":[{"title":"gmpy2","id":"gmpy2","index":"1.1","children":[{"title":"引用","id":"引用","index":"1.1.1"},{"title":"常用例子","id":"常用例子","index":"1.1.2"}]},{"title":"pow","id":"pow","index":"1.2","children":[{"title":"引用","id":"引用-1","index":"1.2.1"},{"title":"常用例子","id":"常用例子-1","index":"1.2.2"}]}]}]}