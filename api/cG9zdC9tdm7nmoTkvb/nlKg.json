{"title":"mvn的使用","date":"2018-10-12T07:07:08.000Z","slug":"mvn的使用","tags":["mvn","配置"],"updated":"2018-10-16T16:55:29.589Z","content":"<h2 id=\"mvn-打包\"><a href=\"#mvn-打包\" class=\"headerlink\" title=\"mvn 打包\"></a>mvn 打包</h2><h3 id=\"本地打包jar\"><a href=\"#本地打包jar\" class=\"headerlink\" title=\"本地打包jar\"></a>本地打包jar</h3><h4 id=\"测试，跳过test\"><a href=\"#测试，跳过test\" class=\"headerlink\" title=\"测试，跳过test\"></a>测试，跳过test</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mvn clean install package -Dmaven.test.skip=true\t# mvn打包跳过test例程。</span><br></pre></td></tr></table></figure>\n<h4 id=\"测试-test\"><a href=\"#测试-test\" class=\"headerlink\" title=\"测试+test\"></a>测试+test</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span>在含有pom的目录上输入mvn pacakge，既可以打包，其中包括Test例程（JUnit会运行进行测试）</span><br><span class=\"line\">mvn package</span><br></pre></td></tr></table></figure>\n<h3 id=\"打包到nexus\"><a href=\"#打包到nexus\" class=\"headerlink\" title=\"打包到nexus\"></a>打包到nexus</h3><h4 id=\"mvn命令打包\"><a href=\"#mvn命令打包\" class=\"headerlink\" title=\"mvn命令打包\"></a>mvn命令打包</h4><p>​    设置</p>\n<p>​    DgroupId Group</p>\n<p>​    DartifactId  Artifact</p>\n<p>​    Dversion 版本信息</p>\n<p>​    Dpackaging 发布类型</p>\n<p>​    Dfile 本地文件路径</p>\n<p>​    Durl 发布url</p>\n<p>​    DrepositoryId 仓库id （可以参考setting里边的server节点的id）</p>\n<p>​    运行下命令就OK</p>\n<p>​    mvn deploy:deploy-file -DgroupId=net.netca.xxx -DartifactId=NetcaXXX -Dversion=1.0.3 -Dpackaging=jar -Dfile=C:/tmp/jar/NetcaXXX-1.0.3.jar -Durl=<a href=\"http://192.168.XX.XX:XX/nexus/content/repositories/thirdparty/\" target=\"_blank\" rel=\"noopener\">http://192.168.XX.XX:XX/nexus/content/repositories/thirdparty/</a> -DrepositoryId=nexus-thirdparty</p>\n<h4 id=\"nexus界面打包\"><a href=\"#nexus界面打包\" class=\"headerlink\" title=\"nexus界面打包\"></a>nexus界面打包</h4><pre><code>1. Sonatype侧边栏：Views/Respositories-Responsitories\n2. 页面栏：Respositories-3rd party\n3. 功能栏：3rd party-Artifact Upload\n4. 操作：\n ​    1. Select GAV Definition Source：选择From POM\n ​    2. Select POM to Upload(button)：选择本地项目需要打包成jar，依赖的pom文件\n ​    3. Select Artifact(s) for Upload(button)：选择本地项目打包好的jar包\n ​    4. Add Artifact：将jar包进行添加到上传列表\n ​    5. Upload Aritifact(s)：上传jar包\n</code></pre><div class=\"article-img\"><p><img src=\"https://pinksmallfan.github.io/WenChongAndJiaoKou/uploads\\nexus打包.png\" alt=\"nexus打包\"></p></div>\n<h2 id=\"常见错误\"><a href=\"#常见错误\" class=\"headerlink\" title=\"常见错误\"></a>常见错误</h2><h3 id=\"jar依赖冲突\"><a href=\"#jar依赖冲突\" class=\"headerlink\" title=\"jar依赖冲突\"></a>jar依赖冲突</h3><p>​    当引用第三方服务的时候，第三方服务的A.jar引用放置在了jdk的jre-lib-ext下，但是项目为maven项目，maven项目同时也包含了有A.jar。</p>\n<p>解决方案：</p>\n<pre><code>1. 换一个没有A.jar的jdk，通过maven来引用A.jar。\n2. 如果jdk不能替换，那么可以尝试maven的exclusions，去除自带的引用。\n举例如下：\n</code></pre><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.apache.axis2<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>axis2-kernel<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>1.7.6<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">exclusions</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">exclusion</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>javax.servlet<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>servlet-api<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">exclusion</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">exclusions</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"Unauthorized\"><a href=\"#Unauthorized\" class=\"headerlink\" title=\"Unauthorized\"></a>Unauthorized</h3><pre><code>1. 描述：当你想上传jar包到仓库nexus-thirdparty时，却发现，通过mvn命令行的方式上传失败，出现&quot;Unauthorized&quot;（没有权限）的错误。\n2. 原因：本地setting配置文件（一般是C:\\Users\\用户名\\\\.m2\\settings.xml），没有配置好对应server id为nexus-thirdparty的账号密码\n3. 解决方案：在setting.xml文件添加server节点\n</code></pre><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">server</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">id</span>&gt;</span>nexus-thirdparty<span class=\"tag\">&lt;/<span class=\"name\">id</span>&gt;</span>            </span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">username</span>&gt;</span>username<span class=\"tag\">&lt;/<span class=\"name\">username</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">password</span>&gt;</span>password<span class=\"tag\">&lt;/<span class=\"name\">password</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">server</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"pom-xml详解\"><a href=\"#pom-xml详解\" class=\"headerlink\" title=\"pom.xml详解\"></a>pom.xml详解</h2>","prev":{"title":"给VPS加固安全设置","slug":"VPS设置安全加固"},"next":{"title":"idea使用技巧大放送","slug":"idea-use-tips"},"link":"http://wenchongjiaokou.info./2018/10/12/mvn的使用/","toc":[{"title":"mvn 打包","id":"mvn-打包","index":"1","children":[{"title":"本地打包jar","id":"本地打包jar","index":"1.1","children":[{"title":"测试，跳过test","id":"测试，跳过test","index":"1.1.1"},{"title":"测试+test","id":"测试-test","index":"1.1.2"}]},{"title":"打包到nexus","id":"打包到nexus","index":"1.2","children":[{"title":"mvn命令打包","id":"mvn命令打包","index":"1.2.1"},{"title":"nexus界面打包","id":"nexus界面打包","index":"1.2.2"}]}]},{"title":"常见错误","id":"常见错误","index":"2","children":[{"title":"jar依赖冲突","id":"jar依赖冲突","index":"2.1"},{"title":"Unauthorized","id":"Unauthorized","index":"2.2"}]},{"title":"pom.xml详解","id":"pom-xml详解","index":"3"}]}